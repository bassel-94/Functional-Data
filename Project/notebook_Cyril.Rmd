---
title: "Notebook Cyril"
author: "Cyril"
date: "2/13/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, include=FALSE}
#-- load libraries
rm(list=ls())
library(fda)
library(refund)
library(tidyverse)
if (!require(fds)) install.packages("fds")
```

```{r, fig.width=12, fig.height=5}
#-- load data
data("Moisturespectrum")

#-- load response variable
data("Moisturevalues")
Y = Moisturevalues
X = Moisturespectrum

#-- plot the data
par(mfrow=c(1,2))
plot(X, col = "grey")
plot(Y, xlab="Sample",ylab="Moisture content", pch=15)
```

```{r, fig.width=12, fig.height=5}
mat = X$y

N = dim(mat)[1]
M = dim(mat)[2]

#-- set number of basis and generate it
basis = create.bspline.basis(c(1,M), nbasis = 25, norder = 4)

#-- plot the generated basis
mat_fd = Data2fd(1:M,t(mat),basis)
plot(mat_fd, lty = 1, col = "grey")
```

```{r}
#-- Ploting the first smoothed trajectory (just to see what it looks like)
plot(mat_fd[1,], ylim = c(0.2,0.5))
```


TO DO EDA
*********

- Point wise mean
- Point wise std
- On the same plot, show upper bound and lower bound and pointwise mean along with the smoothed data.
- Smoothing with GCV , show plot of lambda, smooth the data with best lambda, plot the curvres again
- Repeat mean, std and confidence intervals
- FPCA, plot the first 4 PCA's, see how much components we need to get 90% variance.

TO DO Modeling
**************
- Maybe a test train split ? (bonus)
- Scalar on function regression
- Evaluate model R2

**Maybe scalar on function regression using FPCA (for later)**